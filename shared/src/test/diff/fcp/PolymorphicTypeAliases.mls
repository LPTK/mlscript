:NoJS


type F[A] = forall 'a. (A, 'a) -> (A, 'a)
//│ Defined type alias F[=A]

class Test[B]
  method M = (fun (x: B, y) -> (x, y)) : F[B]
//│ Defined class Test[=B]
//│ Defined Test.M: Test['B] -> F['B]

class Test2[B]
  method M = id (fun x -> id (fun (x: B, y) -> (x, y)) : F[B])
//│ Defined class Test2[=B]
//│ Defined Test2.M: Test2['B] -> anything -> F['B]

def foo = forall 'a. (fun (x: 'a, y) -> (x, y)) : F['a]
//│ foo: F['a]


type G[A] = forall 'a. (A, 'a)
//│ Defined type alias G[+A]

def foo x = forall 'a. (x, x) : G['a]
//│ foo: nothing -> G[nothing]

:e
foo 1
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.28: 	foo 1
//│ ║        	^^^^^
//│ ╟── integer literal of type `1` does not match type `nothing`
//│ ║  l.28: 	foo 1
//│ ╙──      	    ^
//│ res: error | G[nothing]

def foo = forall 'a. fun x -> (x, x) : G['a]
//│ foo: nothing -> G[nothing]

:e
foo 1
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.41: 	foo 1
//│ ║        	^^^^^
//│ ╟── integer literal of type `1` does not match type `nothing`
//│ ║  l.41: 	foo 1
//│ ╙──      	    ^
//│ res: error | G[nothing]

def foo x y = forall 'a. (x, y) : G['a]
//│ foo: ??a -> nothing -> G[nothing]

def foo = forall 'a. fun (x, y) -> (x, y) : G['a]
//│ foo: ('a, nothing,) -> G['a]

def foo = fun a -> forall 'a. fun (x, y) -> (x, y) : G['a]
//│ foo: anything -> (forall 'a. ('a, nothing,) -> G['a])

foo 1 (2, error)
//│ res: G[2]

def foo = fun a -> forall 'a. fun x -> (x, error) : G['a]
//│ foo: anything -> (forall 'a. 'a -> G['a])

foo 1 2
//│ res: G[2]

