:NoJS


type T1 = { x: T1 & { x: T1 } }
type T2 = { x: T2 }
//│ Defined type alias T1
//│ Defined type alias T2

:stats
error : T1 : T2
//│ res: T2
//│ constrain calls  : 6
//│ annoying  calls  : 4
//│ subtyping calls  : 29

type T3 = { x: T2 & { x: T3 } | T3 & { x: T2 } }
//│ Defined type alias T3

:stats
error : T1 : T3
//│ res: T3
//│ constrain calls  : 7
//│ annoying  calls  : 12
//│ subtyping calls  : 457

:stats
error : T2 : T3
//│ res: T3
//│ constrain calls  : 10
//│ annoying  calls  : 12
//│ subtyping calls  : 423

def f: T3 & { x: T1 & 'a } as 'a
//│ f: in T3 & {x: T1} out T3 & {x: nothing}

:stats
f.x
//│ res: nothing
//│ constrain calls  : 5
//│ annoying  calls  : 0
//│ subtyping calls  : 16

g = error : T1 & { x: T2 | 'a } as 'a
//│ g: T1 & {x: T2}

:stats
g.x
//│ res: T1 & T2 & {x: T1}
//│ constrain calls  : 6
//│ annoying  calls  : 4
//│ subtyping calls  : 38

:stats
f = g
//│ T1 & {x: T2}
//│   <:  f:
//│ T3 & {x: nothing}
//│ constrain calls  : 15
//│ annoying  calls  : 17
//│ subtyping calls  : 595


