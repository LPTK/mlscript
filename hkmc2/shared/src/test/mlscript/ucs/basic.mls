
// FIXME
if "hello" then 1 else 0
//│ Elab: { if { let scrut = "hello"‹›; scrut is true -> { else 1‹› }; else 0‹› }‹› }‹›
//│ /!!!\ Uncaught error: scala.MatchError: If(Let(false,scrut@2,Lit(StrLit(hello)),Cons(Branch(Ref(scrut@2),LitPat(BoolLit(true)),Else(Lit(IntLit(1)))),Else(Lit(IntLit(0)))))) (of class hkmc2.semantics.Term$If)
//│ 	at: hkmc2.typing.TypeChecker.typeProd(TypeChecker.scala:84)
//│ 	at: hkmc2.typing.TypeChecker.typeProd(TypeChecker.scala:51)
//│ 	at: hkmc2.DiffMaker.rec(DiffMaker.scala:256)
//│ 	at: hkmc2.DiffMaker.<init>(DiffMaker.scala:276)
//│ 	at: hkmc2.DiffTests.testFun$proxy1$1(DiffTest.scala:100)
//│ 	at: hkmc2.DiffTests.$init$$$anonfun$1$$anonfun$1(DiffTest.scala:104)
//│ 	at: org.scalatest.Transformer.apply$$anonfun$1(Transformer.scala:22)
//│ 	at: org.scalatest.OutcomeOf.outcomeOf(OutcomeOf.scala:85)
//│ 	at: org.scalatest.OutcomeOf.outcomeOf$(OutcomeOf.scala:31)
//│ 	at: org.scalatest.OutcomeOf$.outcomeOf(OutcomeOf.scala:104)

fun negate(x) = 0 - x
//│ Elab: { fun negate(x@2) = -#0(0‹›, x@2#0)‹›; }‹›
//│ Type: Ctor(lit:UnitLit(true),List())

// FIXME
fun f(x) = if x < 0 then negate of x else x
//│ Elab: { fun f(x@2) = if { let scrut = <#0(x@2#0, 0‹›)‹›; scrut is true -> { else negate#0(x@2#1)‹› }; else x@2#2 }‹›; }‹›
//│ /!!!\ Uncaught error: scala.MatchError: If(Let(false,scrut@3,App(Ref(<),Tup(List(Fld(‹›,Ref(x@2),None), Fld(‹›,Lit(IntLit(0)),None)))),Cons(Branch(Ref(scrut@3),LitPat(BoolLit(true)),Else(App(Ref(negate),Tup(List(Fld(‹›,Ref(x@2),None)))))),Else(Ref(x@2))))) (of class hkmc2.semantics.Term$If)
//│ 	at: hkmc2.typing.TypeChecker.typeProd(TypeChecker.scala:84)
//│ 	at: hkmc2.typing.TypeChecker.typeProd$$anonfun$1$$anonfun$3(TypeChecker.scala:44)
//│ 	at: scala.Option.map(Option.scala:242)
//│ 	at: hkmc2.typing.TypeChecker.typeProd$$anonfun$1(TypeChecker.scala:44)
//│ 	at: scala.collection.immutable.List.foreach(List.scala:333)
//│ 	at: hkmc2.typing.TypeChecker.typeProd(TypeChecker.scala:48)
//│ 	at: hkmc2.DiffMaker.rec(DiffMaker.scala:256)
//│ 	at: hkmc2.DiffMaker.<init>(DiffMaker.scala:276)
//│ 	at: hkmc2.DiffTests.testFun$proxy1$1(DiffTest.scala:100)
//│ 	at: hkmc2.DiffTests.$init$$$anonfun$1$$anonfun$1(DiffTest.scala:104)
